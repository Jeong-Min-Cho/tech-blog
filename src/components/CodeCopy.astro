---
---

<script>
  function init() {
    document.querySelectorAll('pre').forEach((pre) => {
      if (pre.querySelector('.copy-btn')) return;
      pre.style.position = 'relative';

      const btn = document.createElement('button');
      btn.className = 'copy-btn absolute top-2 right-2 px-2 py-1 text-xs rounded bg-skin-card text-skin-muted hover:text-skin-base border border-skin-line';
      btn.textContent = 'Copy';

      btn.onclick = async () => {
        const code = pre.querySelector('code');
        if (!code) return;
        await navigator.clipboard.writeText(code.innerText);
        btn.textContent = 'Copied!';
        setTimeout(() => (btn.textContent = 'Copy'), 2000);
      };

      pre.appendChild(btn);
    });
  }

  init();
  document.addEventListener('astro:after-swap', init);
</script>
